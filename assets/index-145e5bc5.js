var Xe=Object.defineProperty;var Pe=(e,n,t)=>n in e?Xe(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var f=(e,n,t)=>(Pe(e,typeof n!="symbol"?n+"":n,t),t);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function t(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(l){if(l.ep)return;l.ep=!0;const r=t(l);fetch(l.href,r)}})();function Q(){let e=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",e+"px")}window.addEventListener("DOMContentLoaded",Q);window.addEventListener("resize",Q);window.addEventListener("orientationchange",Q);class Z{constructor(n,t,i){f(this,"r",0);f(this,"g",0);f(this,"b",0);this.r=n,this.g=t,this.b=i}}class Te{constructor(n,t){f(this,"start",new L(0,0));f(this,"end",new L(0,0));f(this,"leaf",!1);f(this,"branchStart",!1);f(this,"rot",0);this.start=n,this.end=t,this.leaf=!1,this.branchStart=!1,this.rot=0}}class L{constructor(n,t){f(this,"x",0);f(this,"y",0);this.x=n,this.y=t}}class V{constructor(n,t){f(this,"pos",new L(0,0));f(this,"rot",0);this.pos=new L(n.x,n.y),this.rot=t}}class o{constructor(n,t){f(this,"successor","");f(this,"weight",0);this.successor=n,this.weight=t}}class a{constructor(n,t,i,l){f(this,"predecessor","");f(this,"successors",[]);f(this,"contextL","");f(this,"contextR","");this.predecessor=n,this.successors=t,this.contextL=i,this.contextR=l}}class d{constructor(n,t,i,l,r,s){f(this,"name","");f(this,"start","");f(this,"theta",0);f(this,"factor",0);f(this,"rules",[]);f(this,"ignore",[""]);this.name=n,this.start=t,this.theta=i,this.factor=l,this.rules=r,this.ignore=s}}const W="inline-flex justify-center items-center px-4 py-2 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 focus:bg-gray-700 active:bg-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition ease-in-out duration-150 bg-white rounded-lg w-24 h-12 mx-auto my-4 active:scale-95",He=document.getElementById("GenerateButton"),he=document.getElementById("LSystemsButton"),ge=document.getElementById("OutputButton"),me=document.getElementById("HideButton"),M=document.getElementById("oView");document.getElementById("fDiv");const Ge=document.getElementById("fSettings"),N=document.getElementById("fContainer"),z=document.getElementById("fView"),x=document.getElementById("fCanvas"),v=x.getContext("2d"),Fe=document.getElementById("fSettingsPresets"),Ae=document.getElementById("fSettingsCol"),Oe=document.getElementById("fSettingsVariance"),Ve=document.getElementById("fSettingsAnimate"),Ye=document.getElementById("fSettingsInterval"),De=document.getElementById("fSettingsLeaves"),We=document.getElementById("fSettingsForest"),pe=document.getElementById("fSettingsCount"),ye=document.getElementById("fSettingsAxiom"),ve=document.getElementById("fSettingsTheta"),b=document.getElementById("fSettingsReplacementDiv"),je=document.getElementById("fSettingsReplacementAdd"),be=document.getElementById("fSettingsIterations"),xe=document.getElementById("fSettingsLength"),Se=document.getElementById("fSettingsCanvas");He.onclick=function(){D()};he.onclick=function(){le(_,0,ee,0)};ge.onclick=function(){le(_,1,ee,1)};me.onclick=function(){le(_,2,ee,2)};je.onclick=function(){Ne()};Fe.onchange=function(){Ie(parseInt(Fe.value)),D()};const _=[N,M,Ge],ee=[he,ge,me];v.lineWidth=1;let q=1,p="",A="",S=new V(new L(0,0),0),O=0,U=0,E=[],R=0,j=0,K=0,T=0,k=0,H=0,C=0,$=0,y=0,G=0,X=0,J=10,te=!0,Le=!1,Y=!1,P=new Z(0,0,0),ne=0,u=[],c=[];function le(e,n,t,i){let l=e.length,r=t.length;if(!(n>l)&&!(i>r)){if(l>0)for(let s=0;s<l;s++)s===n?e[s].style.display="":e[s].style.display="none";if(r>0)for(let s=0;s<r;s++)s===i?t[s].dataset.state="selected":t[s].dataset.state=""}}function Ke(){if(c.length>0){let e=document.getElementById("fSettingsPresets");if(e!==null)for(let n=0;n<c.length;n++){let t=document.createElement("option");t.value=n.toString(),t.innerHTML=c[n].name,e.appendChild(t)}}}function Ie(e){R=e,ye.value=c[R].start,ve.value=c[R].theta.toString(),Be(c[R]),be.value="2",xe.value="250",Se.value="1"}function Be(e){b.innerHTML="";for(let t=0;t<e.rules.length;t++){b.innerHTML+="<div>Rule "+(t+1)+"</div>";let i=e.rules[t].predecessor;b.innerHTML+=`
    <div class="replacementRules" id="replacementRule`+t+'" data-index="'+t+'" data-successorCount="'+e.rules[t].successors.length+'">',b.innerHTML+='<label for="predecessor'+t+'">Predecessor</label>',b.innerHTML+='<textarea id="predecessor'+t+'" class="border border-black rounded-lg p-2 m-2">'+i+"</textarea>";for(let s=0;s<e.rules[t].successors.length;s++){let w=e.rules[t].successors[s].successor,h=e.rules[t].successors[s].weight;b.innerHTML+=`
        <label for="successor`+t+s+`">Successor</label>
        <textarea id="successor`+t+s+'" class="border border-black rounded-lg p-2 m-2">'+w+`</textarea>
        <label for="weight`+t+s+`">Weight</label>
        <textarea id="weight`+t+s+'" class="border border-black rounded-lg p-2 m-2">'+h+`</textarea>
        <button class="`+W+' p-2 border border-black flex justify-center items-center" id="removeSuccessor'+t+s+'" onclick="RemoveSuccessor('+t+","+s+`)">Remove Successor</button>
        <br>`,b.innerHTML+='<div class="fBorder"></div>'}b.innerHTML+=`
    <button class="`+W+' p-2 border border-black flex justify-center items-center" id="add'+t+'" onclick="AddSuccessor('+t+`)">Add Successor</button>
    <br>
    <button class="`+W+' p-2 border border-black flex justify-center items-center" id="removeRule'+t+'" onclick="RemoveRule('+t+`)">Remove Rule</button>
    <br>
    `;let l=e.rules[t].contextL,r=e.rules[t].contextR;l!==void 0&&(b.innerHTML+=`
      <label for="contextLeft`+t+`">Left Context</label>
      <textarea id="contextLeft`+t+'" class="border border-black rounded-lg p-2 m-2">'+l+"</textarea>"),r!==void 0&&(b.innerHTML+=`
      <label for="contextRight`+t+`">Right Context</label>
      <textarea id="contextRight`+t+'" class="border border-black rounded-lg p-2 m-2">'+r+"</textarea>"),b.innerHTML+=`
    </div>
    <br>`,b.innerHTML+='<div class="fBorder"></div>'}let n=e.ignore;n!==void 0&&(b.innerHTML+=`
    <label for="ignore">Ignore List</label>
    <textarea id="ignore" class="border border-black rounded-lg p-2 m-2">`+n.toString()+"</textarea>")}function Ne(){let e=new a("",[],"","");c[R].rules.push(e),Be(c[R])}function ze(){N.style.width=window.innerWidth+"px",N.style.height=window.innerHeight*.85+"px",z.style.width=window.innerWidth+"px",z.style.height=window.innerHeight*.85+"px",x.width=window.innerWidth,x.height=window.innerHeight*.85,D()}function qe(e,n,t){v.scale(q,q),v.clearRect(0,0,x.width,x.height),x.width=window.innerWidth,x.height=window.innerHeight*.85,E.length=0,j=x.width/2,K=x.height/2,T=j,k=j,H=K,C=K,U=e.theta,J=parseFloat(Ye.value),te=Ve.checked,Le=De.checked,Y=We.checked,G=0,X=0;let i=Ze(Ae.value);M.innerHTML="",u=[];let l=1;Y&&(l=parseFloat(pe.value));for(let r=0;r<l;r++){P.r=i.r,P.g=i.g,P.b=i.b,p=e.start,O=t,M.innerHTML+=e.start,M.innerHTML+="<br>",M.innerHTML+="<br>";for(let s=0;s<n;s++)Ue(e);m=r,$e(r),Qe(r)}}function Ue(e){O/=e.factor,A="";for(let n=0;n<p.length;n++){let t=p.charAt(n),i=!1;for(let l=0;l<e.rules.length;l++)if(t==e.rules[l].predecessor){let r=e.rules[l].contextL,s=e.rules[l].contextR;if(r!==void 0&&n>1&&e.ignore!==void 0&&r!=="*"){let w=p.charAt(n-1);if(w==="]"){let h=n,F=1,g="";for(;h>0;){if(F++,g=p.charAt(n-F),g==="["){F++,w=p.charAt(n-F);break}h--}}if(w!==r&&!e.ignore.includes(w))continue}if(s!==void 0&&n<p.length-1&&e.ignore!==void 0&&s!=="*"){let w=p.charAt(n+1);if(w==="["){let h=n,F=1,g="";for(;h<p.length;){if(F++,g=p.charAt(n+F),g==="]"){F++,w=p.charAt(n+F);break}h++}}if(w!==s&&!e.ignore.includes(w))continue}if(e.rules[l].successors.length>0){let w=Math.random(),h=0;for(let F=0;F<e.rules[l].successors.length;F++)if(h+=e.rules[l].successors[F].weight,h>=w){A+=e.rules[l].successors[F].successor,i=!0;break}}else A+=e.rules[l].successors[0].successor,i=!0}i||(A+=t)}p=A,M.innerHTML+=p,M.innerHTML+="<br>",M.innerHTML+="<br>"}function $e(e){u[e]=[],E.length=0;let n=parseFloat((x.width/2).toFixed(2)),t=parseFloat((x.height/2).toFixed(2));if(Y){t=parseFloat(x.height.toFixed(2));let i=x.width*.8/parseFloat(pe.value),l=Math.floor(Math.random()*i)*e;Math.random()<.5?n+=l:n-=l}S=new V(new L(n,t),270);for(let i=0;i<p.length;i++){let l=p.charAt(i);if(l=="F"||l=="G"){let r=Je(S,O);u[e].push(r),de(S,O)}else if(l=="f")de(S,O);else if(l=="+")fe(S,U);else if(l=="-")fe(S,-U);else if(l=="["){let r=new V(new L(S.pos.x,S.pos.y),S.rot);E.push(r)}else l=="]"&&E.length>0&&(S=E[E.length-1],E.length=E.length-1,u[e].length>0&&(u[e][u[e].length-1].leaf=!0))}u[e].length>0&&(u[e][u[e].length-1].leaf=!0);for(let i=0;i<u[e].length;i++){let l=!1;for(let r=0;r<u[e].length;r++)if(u[e][i].start.x===u[e][r].start.x&&u[e][i].start.y===u[e][r].start.y&&i!==r){l=!0;break}l&&(u[e][i].branchStart=!0)}}function Je(e,n){let t=new L(e.pos.x,e.pos.y),i=e.rot*(Math.PI/180),l=e.pos.x+n*Math.cos(i),r=e.pos.y+n*Math.sin(i);l=parseFloat(l.toFixed(2)),r=parseFloat(r.toFixed(2));let s=new L(l,r);t.x>k&&(k=t.x),s.x>k&&(k=s.x),t.y>C&&(C=t.y),s.y>C&&(C=s.y),t.x<T&&(T=t.x),s.x<T&&(T=s.x),t.y<H&&(H=t.y),s.y<H&&(H=s.y);let w=new Te(new L(t.x,t.y),new L(s.x,s.y));return w.rot=e.rot,w}function de(e,n){let t=e.rot*(Math.PI/180),i=e.pos.x+n*Math.cos(t),l=e.pos.y+n*Math.sin(t);S.pos.x=parseFloat(i.toFixed(2)),S.pos.y=parseFloat(l.toFixed(2))}function fe(e,n){let t=e.rot+n;return t>=360&&(t=360-(360-t)),t<0&&(t=360+t),new V(new L(e.pos.x,e.pos.y),e.rot=t)}function Qe(e){if(Y===!1&&(G=(k-T)/2,X=(C-H)/2,G-=k-u[e][0].start.x,X-=C-u[e][0].start.y),v.strokeStyle=Ee(ne,J),te)y=0,clearInterval($),$=setInterval(we,J);else for(let n=0;n<u[e].length;n++)y=n,we()}let m=0;function we(){if(v.strokeStyle=Ee(ne,1),v.beginPath(),v.moveTo(u[m][y].start.x+G,u[m][y].start.y+X),v.lineTo(u[m][y].end.x+G,u[m][y].end.y+X),v.stroke(),Le&&u[m][y].leaf){v.fillStyle=v.strokeStyle;let e=!0;for(let n=0;n<u[m].length;n++)if(u[m][y].end.x===u[m][n].start.x&&u[m][y].end.y===u[m][n].start.y){e=!1;break}if(e){let n=100/z.scrollHeight*(u[m][y].end.y+X),t=Math.abs((100-n)/10),i=t+Math.random(),l=t+Math.random();v.beginPath(),v.ellipse(u[m][y].end.x+G,u[m][y].end.y+X,i,l,Math.PI/4,0,2*Math.PI),v.fill()}}te&&(y++,y>=u[m].length&&clearInterval($))}function Ee(e,n){let t=P.r,i=P.g,l=P.b,r=Math.floor(Math.random()*e),s=Math.floor(Math.random()*e),w=Math.floor(Math.random()*e),h=Math.random(),F=t-r,g=i-s,B=l-w;return h>.5&&(F=t+r,g=i+s,B=l+w),F<0&&(F=0),F>255&&(F=255),g<0&&(g=0),g>255&&(g=255),B<0&&(B=0),B>255&&(B=255),P=new Z(F,g,B),"rgba("+F+","+g+","+B+","+n+")"}function Ze(e){if(/^#([a-f0-9]{3}){1,2}$/.test(e)){e.length==4&&(e="#"+[e[1],e[1],e[2],e[2],e[3],e[3]].join(""));let n="0x"+e.substring(1),t=parseFloat(n)>>16&255,i=parseFloat(n)>>8&255,l=parseFloat(n)&255;return new Z(t,i,l)}}function D(){let e=ye.value.toString(),n=parseInt(ve.value),t=parseInt(be.value),i=parseInt(xe.value);ne=parseFloat(Oe.value),q=parseInt(Se.value);let l=document.getElementsByClassName("replacementRules"),r=[""];document.getElementById("ignore")!==null&&(r=document.getElementById("ignore").value.split(","));let s=new d("-",e,n,4,[],r),w=[];for(let h=0;h<l.length;h++){let F=l[h].dataset.index,g=l[h].dataset.successorcount,B=parseInt(g),se=document.getElementById("predecessor"+F),Me=se?se.value:"",re="*",oe="*";if(document.getElementById("contextLeft"+F)!==null){let I=document.getElementById("contextLeft"+F);re=I?I.value:""}if(document.getElementById("contextRight"+F)!==null){let I=document.getElementById("contextRight"+F);oe=I?I.value:""}let ie=new a(Me,[],re,oe),ae=[];for(let I=0;I<B;I++){let ce=document.getElementById("successor"+F+I),Re=ce?ce.value:"",ue=document.getElementById("weight"+F+I),ke=ue?parseFloat(ue.value):1,Ce=new o(Re,ke);ae.push(Ce)}ie.successors=ae,w.push(ie)}s.rules=w,qe(s,t,i)}function _e(){Ke(),Ie(R),D()}window.addEventListener("resize",ze);document.addEventListener("DOMContentLoaded",_e);let et=new d("Koch Island","F-F-F-F",90,4,[new a("F",[new o("F-F+F+FF-F-F+F",1)],"*","*")],[""]);c.push(et);let tt=new d("Koch Curve 2","-F",90,4,[new a("F",[new o("F+F-F-F+F",1)],"*","*")],[""]);c.push(tt);let nt=new d("Lakes and Islands","F+F+F+F",90,4,[new a("F",[new o("F+f-FF+F+FF+Ff+FF-f+FF-F-FF-Ff-FFF",1)],"*","*"),new a("f",[new o("ffffff",1)],"*","*")],[""]);c.push(nt);let lt=new d("Ruleset 1","F-F-F-F",90,4,[new a("F",[new o("FF-F-F-F-F-F+F",1)],"*","*")],[""]);c.push(lt);let st=new d("Ruleset 2","F-F-F-F",90,4,[new a("F",[new o("FF-F-F-F-FF",1)],"*","*")],[""]);c.push(st);let rt=new d("Ruleset 3","F-F-F-F",90,4,[new a("F",[new o("FF-F+F-F-FF",1)],"*","*")],[""]);c.push(rt);let ot=new d("Ruleset 4","F-F-F-F",90,4,[new a("F",[new o("FF-F--F-F",1)],"*","*")],[""]);c.push(ot);let it=new d("Ruleset 5","F-F-F-F",90,4,[new a("F",[new o("F-FF--F-F",1)],"*","*")],[""]);c.push(it);let at=new d("Ruleset 6","F-F-F-F",90,4,[new a("F",[new o("F-F+F-F-F",1)],"*","*")],[""]);c.push(at);let ct=new d("Dragon Curve","FX",90,4,[new a("X",[new o("X+YF+",1)],"*","*"),new a("Y",[new o("-FX-Y",1)],"","")],[""]);c.push(ct);let ut=new d("Sierpinski Curve","F--XF--F--XF",45,4,[new a("X",[new o("XF+G+XF--F--XF+G+X",1)],"*","*")],[""]);c.push(ut);let Ft=new d("Sierpinkski Triangle","F-G-G",120,4,[new a("F",[new o("F-G+F+G-F",1)],"*","*"),new a("G",[new o("GG",1)],"*","*")],[""]);c.push(Ft);let dt=new d("Koch Curve 1","F",60,4,[new a("F",[new o("F+F--F+F",1)],"*","*")],[""]);c.push(dt);let ft=new d("Koch Snowflake","F--F--F",60,4,[new a("F",[new o("F+F--F+F",1)],"*","*")],[""]);c.push(ft);let wt=new d("Hilbert Curve","A",90,4,[new a("A",[new o("+BF-AFA-FB+",1)],"*","*"),new a("B",[new o("-AF+BFB+FA-",1)],"*","*")],[""]);c.push(wt);let ht=new d("Levy C Curve","F",45,4,[new a("F",[new o("+F--F+",1)],"*","*")],[""]);c.push(ht);let gt=new d("Star","F",77,4,[new a("F",[new o("F++F",1)],"*","*")],[""]);c.push(gt);let mt=new d("Pentigree Curve","F-F-F-F-F",72,4,[new a("F",[new o("F-F-F++F+F-F",1)],"*","*")],[""]);c.push(mt);let pt=new d("Snowflake","F++F++F++F++F",36,4,[new a("F",[new o("F++F++F+++++F-F++F",1)],"*","*")],[""]);c.push(pt);let yt=new d("Gosper Curve","F",60,4,[new a("F",[new o("F-G--G+F++FF+G-",1)],"*","*"),new a("G",[new o("+F-GG--G-F++F+G",1)],"*","*")],[""]);c.push(yt);let vt=new d("Fractal Plant 1","X",25,4,[new a("X",[new o("F+[[X]-X]-F[-FX]+X",1)],"*","*"),new a("F",[new o("FF",1)],"*","*")],[""]);c.push(vt);let bt=new d("Fractal Plant 2","F",25.7,4,[new a("F",[new o("F[+F]F[-F]F",1)],"*","*")],[""]);c.push(bt);let xt=new d("Fractal Plant 3","F",22.5,4,[new a("F",[new o("FF-[-F+F+F]+[+F-F-F]",1)],"*","*")],[""]);c.push(xt);let St=new d("Fractal Plant 4","F",20,4,[new a("F",[new o("F[+F]F[-F][F]",1)],"*","*")],[""]);c.push(St);let Lt=new d("Fractal Plant 5","X",20,4,[new a("X",[new o("F[+X]F[-X]+X",1)],"*","*"),new a("F",[new o("FF",1)],"*","*")],[""]);c.push(Lt);let It=new d("Fractal Plant 6","X",25.7,4,[new a("X",[new o("F[+X][-X]FX",1)],"*","*"),new a("F",[new o("FF",1)],"*","*")],[""]);c.push(It);let Bt=new d("Fractal Plant 7","X",22.5,4,[new a("X",[new o("[[X]+X]+F[+FX]-X",1)],"",""),new a("F",[new o("FF",1)],"*","*")],[""]);c.push(Bt);let Et=new d("Fractal Plant 8","F",20,4,[new a("F",[new o("F[+F]F[-F]F",.34),new o("F[+F]F",.33),new o("F[-F]F",.33)],"*","*")],[""]);c.push(Et);let Mt=new d("Fractal Plant 9","F1F1F1",22.5,4,[new a("0",[new o("0",1)],"0","0"),new a("0",[new o("1[+F1F1]",1)],"0","1"),new a("1",[new o("1",1)],"0","0"),new a("1",[new o("1",1)],"0","1"),new a("0",[new o("0",1)],"1","0"),new a("0",[new o("1F1",1)],"1","1"),new a("1",[new o("0",1)],"1","0"),new a("1",[new o("0",1)],"1","1"),new a("+",[new o("-",1)],"*","*"),new a("-",[new o("+",1)],"*","*")],["+","-","F"]);c.push(Mt);
